function sendToChatRoom(){$.ajax({type:"GET",url:"getroom.php",success:function(e){if(e==""){var t="<?php echo uniqid('chat_'); ?>";var n="chat.php?id="+t;$.ajax({type:"POST",url:"writeroom.php",data:{chatroom_id:t},success:function(e){$.cookie("current_chatroom",t);window.location=n}})}else{var n="chat.php?id="+e;$.cookie("current_chatroom",e);window.location=n}}})}function showVerifyBox(){$("#dialog-confirm").css("border-bottom","none");$("#dialog-confirm").dialog({resizable:false,modal:true,buttons:{Cancel:function(){$(this).dialog("close")},"Ready?":function(){getQuestion()}}});$("#dialog-confirm").css("padding","20px")}function getQuestion(){var e=1e4;var t=document.getElementById("box-text");$.ajax({type:"GET",url:"getquestion.php",data:{},success:function(n){var r=n.split("###");var i=r[0];var n=r[1];var s="<b>"+n+'</b><br><br><table><tr><td><form id="qa">';for(var o=2;o<r.length;o++){s+='<input type= "radio" name="answer" value="'+r[o]+'" style="margin-right: 5px;"/>'+r[o]+"<br>"}s+='</form></td><td><b><span id="timer">10</span></b></td></tr></table>';t.innerHTML=s;var u=10;var a=setInterval(function(){u--;document.getElementById("timer").innerHTML=u;if(u==0){clearInterval(a);var e=$.cookie("attempts");if(e==null)e=1;else e++;$.cookie("attempts",e);document.getElementById("timer").innerHTML="Sorry, too slow!";$(".ui-dialog-buttonpane button:contains('Submit')").css("display","none");setTimeout(function(){window.location="index.php"},2e3)}},e/10);$("#dialog-confirm").dialog({resizable:false,modal:true,buttons:{Submit:function(){clearInterval(a);var e=this;var t=document.getElementsByName("answer");var n="";for(var r=0,s=t.length;r<s;r++){if(t[r].checked){n=t[r].value}}$.ajax({type:"GET",url:"getanswer.php",data:{question_num:i,answer:n},success:function(t){if(t=="true"){$.cookie("verified",true);document.getElementById("timer").innerHTML="Correct!";$(".ui-dialog-buttonpane button:contains('Submit')").css("display","none");setTimeout(function(){sendToChatRoom()},1500)}else{var n=$.cookie("attempts");if(n==null)n=1;else n++;document.getElementById("timer").innerHTML="Sorry, that was incorrect.";$(".ui-dialog-buttonpane button:contains('Submit')").css("display","none");$.cookie("attempts",n);setTimeout(function(){$(e).dialog("close");window.location="index.php"},2e3)}}})}}})}})}var userID=$.cookie("user_id");if(userID){var current_chatroom=$.cookie("current_chatroom");console.log(current_chatroom);if(current_chatroom){$.ajax({type:"POST",url:"rate.php",data:{chat_filename:"conversations/"+current_chatroom+".txt",rating:$.cookie("user_id")+":  -1"},success:function(e){console.log("WROTE TO RATE.PHP");$.ajax({type:"POST",url:"clearroom.php",data:{current_chatroom:$.cookie("current_chatroom")},success:function(e){$.removeCookie("current_chatroom");window.location="index.php";console.log("CLEARED THE ROOM")}})}})}}else{userID="<?php echo uniqid(); ?>";$.cookie("user_id",userID,{expires:31,path:"/"})}$(".chatroom_room_a").click(function(){var e=$.cookie("verified");if(e){sendToChatRoom()}else{var t=$.cookie("attempts");if(t==2){alert("Sorry, you have answered incorrectly too many times. Are you actually from Stanford?")}else{showVerifyBox()}}})